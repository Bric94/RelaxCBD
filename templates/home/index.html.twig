{# templates/home/index.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Accueil - Relax CBD Shop
{% endblock %}

{% block body %}
	<header class="banner">
		<div class="banner-content">
			<h1>Bienvenue chez Relax CBD Shop</h1>
			<h2>Découvrez nos produits à base de CBD, 100 % naturels et certifiés.</h2>
			<a href="{{ path('product_index') }}" class="btn-primary">Explorer nos Produits</a>
		</div>
	</header>

	<div class="container">
		<div class="features">
			<div class="feature">
				<h3>Nos Produits</h3>
				{% if randomProducts|length > 0 %}
					<div class="carousel-container product-slider-container">
						<button class="prev">‹</button>
						<div class="carousel-wrapper">
							{% for product in randomProducts %}
								<div class="carousel-item">
									<img src="{{ asset('uploads/products/' ~ product.image) }}" alt="{{ product.name }}" class="carousel-img">
									<h4>{{ product.name }}</h4>
									<a href="{{ path('product_show', { id: product.id }) }}" class="btn-secondary">Voir produit</a>
								</div>
							{% endfor %}
						</div>
						<button class="next">›</button>
					</div>
				{% else %}
					<p>Aucun produit disponible.</p>
				{% endif %}
			</div>

			<div class="feature">
				<h3>Votre Panier</h3>
				{% if cartItems is empty %}
					<p>Votre panier est vide.</p>
				{% else %}
					<div class="carousel-container cart-slider-container">
						<button class="prev">‹</button>
						<div class="carousel-wrapper">
							{% for item in cartItems %}
								<div class="carousel-item">
									<img src="{{ asset('uploads/products/' ~ item.product.image) }}" alt="{{ item.product.name }}" class="carousel-img">
									<p>
										<strong>{{ item.product.name }}</strong>
									</p>
									<p>Quantité :
										{{ item.quantity }}
										{% if item.weight %}
											g
										{% endif %}
									</p>
								</div>
							{% endfor %}
						</div>
						<button class="next">›</button>
					</div>
					<p class="cart-summary">Total panier :
						<strong>{{ total|number_format(2, ',', ' ') }}
							€</strong>
					</p>
					<a href="{{ path('cart_index') }}" class="btn-secondary">Accéder au panier</a>
				{% endif %}
			</div>

			<div class="feature">
				<h3>Mon Compte</h3>
				{% if app.user %}
					<div class="profile-container">
						<img src="{{ asset(profilePicture) }}" alt="Photo de profil" class="profile-image">
						<p class="profile-name">Bienvenue
							<strong>{{ app.user.firstName }}</strong>
							!</p>
						<p class="profile-email">{{ app.user.email }}</p>
					</div>
					<a href="{{ path('user_index') }}" class="btn-secondary">Voir mon compte</a>
				{% else %}
					<p>Connectez-vous pour suivre vos commandes.</p>
					<a href="{{ path('app_login') }}" class="btn-secondary">Se connecter</a>
				{% endif %}
			</div>
		</div>
	</div>

	<div class="container shop-section">
		<div class="map-container" id="map"></div>
		<div class="shop-info">
			<h3>Relax CBD Shop vous accueil</h3>
			<img src="{{ asset('images/shop/photo-shop.png') }}" alt="Boutique Relax CBD Shop" class="shop-photo">
			<p>5 avenue du Midi, Golfe-Juan 06220</p>
			<a href="https://maps.app.goo.gl/yimMDdtT8deH2BRR8" target="_blank" class="btn-primary">Voir sur Google Maps</a>
		</div>
	</div>


	{# Modal Newsletter #}
	<div id="newsletter-modal" class="newsletter-modal" data-user-email="{{ app.user ? app.user.email : '' }}">
		<div class="newsletter-modal__dialog">
			<button type="button" class="newsletter-modal__close" aria-label="Fermer la popup">&times;</button>
			<h3 class="newsletter-modal__title">Inscrivez-vous à la Newsletter</h3>
			<p class="newsletter-modal__desc">
				Recevez nos offres exclusives et conseils bien-être directement dans votre boîte mail.
			</p>

			<form id="newsletter-form" action="{{ path('newsletter_subscribe') }}" method="POST" class="newsletter-modal__form" novalidate>
				<input id="newsletter-email" name="email" type="email" placeholder="Votre e-mail" required>
				<button type="submit" class="btn-primary">S'inscrire</button>
			</form>

			<p id="newsletter-user-email" class="newsletter-modal__user-email"></p>

			<div class="newsletter-modal__actions">
				<button type="button" class="btn-secondary btn-remind">Me le rappeler plus tard</button>
				<button type="button" class="btn-secondary btn-never">Ne plus afficher</button>
			</div>
		</div>
	</div>
{% endblock %}
